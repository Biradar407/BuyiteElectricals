<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sheet Test</title>
</head>
<body>
  <h2>Save Data to Sheet</h2>
  <input type="text" id="name" placeholder="Name">
  <input type="number" id="value" placeholder="Value">
  <button onclick="saveData()">Save</button>
  <pre id="saveResult"></pre>

  <h2>Fetch Data from Sheet</h2>
  <button onclick="fetchData()">Fetch</button>
  <pre id="fetchResult"></pre>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbylUykNBa-0osCYFhJMxmkSMhvDX0nFR4Ef8hNi-VyNIdLi3YIXLPPMOmDYHT80mfVL/exec"; // <-- replace with deployed URL

function saveData() {
  const name = document.getElementById("name").value;
  const value = parseFloat(document.getElementById("value").value);
  if (!name || isNaN(value)) { alert("Fill all fields"); return; }

  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify({ action: "saveTestData", name, value }),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(data => document.getElementById("saveResult").textContent = JSON.stringify(data, null, 2))
  .catch(err => document.getElementById("saveResult").textContent = err);
}

function fetchData() {
  fetch(GAS_URL + "?action=getTestData")
    .then(res => res.json())
    .then(data => document.getElementById("fetchResult").textContent = JSON.stringify(data, null, 2))
    .catch(err => document.getElementById("fetchResult").textContent = err);
}
</script>
</body>
</html>
